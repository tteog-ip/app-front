{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState}from'react';import{useParams}from'react-router-dom';import SortSelectArea from'../ProductsSorted/SortSelectArea/SortSelectArea';import Product from'../Product/Product';import ModalBuyNow from'../ModalBuyNow/ModalBuyNow';import{TRANSELATE}from'../Transelate';import{API_ADDRESS}from'../../../apiConfig';import'./SortedProducts.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SortedProducts=function SortedProducts(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isProductLoading=_useState2[0],setIsProductLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),productsList=_useState4[0],setProductsList=_useState4[1];var _useParams=useParams(),mainCategory=_useParams.mainCategory,subCategory=_useParams.subCategory;var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isPopModal=_useState6[0],setIsPopModal=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),selectedProduct=_useState8[0],setSelectedProduct=_useState8[1];var PopUpModalBuyNow=function PopUpModalBuyNow(product){setIsPopModal(true);setSelectedProduct(product);};var updateLike=function updateLike(id){var updatedList=productsList.map(function(product){if(id===product.id){return product.is_like_True?_objectSpread(_objectSpread({},product),{},{is_like_True:!product.is_like_True,like_num:product.like_num-1}):_objectSpread(_objectSpread({},product),{},{is_like_True:!product.is_like_True,like_num:product.like_num+1});}else{return _objectSpread({},product);}});setProductsList(updatedList);};var fetchData=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var address,data,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(mainCategory==='all'){address=API_ADDRESS.product_all;}else{address=subCategory?\"\".concat(API_ADDRESS.products_category).concat(subCategory):\"\".concat(API_ADDRESS.products_menu).concat(mainCategory);}_context.next=3;return fetch(address);case 3:data=_context.sent;_context.next=6;return data.json();case 6:res=_context.sent;setProductsList(res.product_list.sort(function(a,b){return Date.parse(b.create_at)-Date.parse(a.create_at);}));case 8:case\"end\":return _context.stop();}}},_callee);})),[mainCategory,subCategory]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsProductLoading(true);_context2.next=3;return fetchData();case 3:setIsProductLoading(false);case 4:case\"end\":return _context2.stop();}}},_callee2);}))();},[fetchData,subCategory,mainCategory]);var adjustList=function adjustList(products){setProductsList(products);};var checkCategory=function checkCategory(name,category){return!!subCategory?name===mainCategory&&category===subCategory:name===mainCategory;};return!isProductLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"sortedProducts\",children:[isPopModal&&/*#__PURE__*/_jsx(ModalBuyNow,{setIsPopModal:setIsPopModal,infoTag:adjustList.description,product:selectedProduct}),/*#__PURE__*/_jsx(\"div\",{className:isPopModal?'mask':'maskOff'}),/*#__PURE__*/_jsxs(\"div\",{className:\"sortedProductsHead\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sortedProductsTitle\",children:[\"\".concat(TRANSELATE[mainCategory]),subCategory&&\" > \".concat(TRANSELATE[subCategory])]}),/*#__PURE__*/_jsx(SortSelectArea,{adjustList:adjustList,productsList:productsList})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sortedProductsContainer\",children:(mainCategory==='all'?productsList:productsList.filter(function(_ref3){var _ref3$category=_ref3.category,name=_ref3$category.name,category=_ref3$category.category;return checkCategory(name,category);})).map(function(el){return/*#__PURE__*/_jsx(Product,{el:el,id:el.id,btnOnClick:PopUpModalBuyNow,updateLike:updateLike},el.id);})})]});};export default SortedProducts;","map":{"version":3,"sources":["C:/Users/user/Desktop/2차프로젝트/DrTart-frontend/src/pages/ProductList/SortedProducts/SortedProducts.js"],"names":["React","useCallback","useEffect","useState","useParams","SortSelectArea","Product","ModalBuyNow","TRANSELATE","API_ADDRESS","SortedProducts","isProductLoading","setIsProductLoading","productsList","setProductsList","mainCategory","subCategory","isPopModal","setIsPopModal","selectedProduct","setSelectedProduct","PopUpModalBuyNow","product","updateLike","id","updatedList","map","is_like_True","like_num","fetchData","address","product_all","products_category","products_menu","fetch","data","json","res","product_list","sort","a","b","Date","parse","create_at","adjustList","products","checkCategory","name","category","description","filter","el"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport SortSelectArea from '../ProductsSorted/SortSelectArea/SortSelectArea';\nimport Product from '../Product/Product';\nimport ModalBuyNow from '../ModalBuyNow/ModalBuyNow';\nimport { TRANSELATE } from '../Transelate';\nimport { API_ADDRESS } from '../../../apiConfig';\nimport './SortedProducts.scss';\n\nconst SortedProducts = () => {\n  const [isProductLoading, setIsProductLoading] = useState(false);\n  const [productsList, setProductsList] = useState([]);\n  const { mainCategory, subCategory } = useParams();\n  const [isPopModal, setIsPopModal] = useState(false);\n  const [selectedProduct, setSelectedProduct] = useState({});\n\n  const PopUpModalBuyNow = product => {\n    setIsPopModal(true);\n    setSelectedProduct(product);\n  };\n\n  const updateLike = id => {\n    const updatedList = productsList.map(product => {\n      if (id === product.id) {\n        return product.is_like_True\n          ? {\n              ...product,\n              is_like_True: !product.is_like_True,\n              like_num: product.like_num - 1,\n            }\n          : {\n              ...product,\n              is_like_True: !product.is_like_True,\n              like_num: product.like_num + 1,\n            };\n      } else {\n        return { ...product };\n      }\n    });\n    setProductsList(updatedList);\n  };\n\n  const fetchData = useCallback(async () => {\n    let address;\n    if (mainCategory === 'all') {\n      address = API_ADDRESS.product_all;\n    } else {\n      address = subCategory\n        ? `${API_ADDRESS.products_category}${subCategory}`\n        : `${API_ADDRESS.products_menu}${mainCategory}`;\n    }\n    const data = await fetch(address);\n    const res = await data.json();\n\n    setProductsList(\n      res.product_list.sort(\n        (a, b) => Date.parse(b.create_at) - Date.parse(a.create_at)\n      )\n    );\n  }, [mainCategory, subCategory]);\n\n  useEffect(() => {\n    (async () => {\n      setIsProductLoading(true);\n      await fetchData();\n      setIsProductLoading(false);\n    })();\n  }, [fetchData, subCategory, mainCategory]);\n\n  const adjustList = products => {\n    setProductsList(products);\n  };\n\n  const checkCategory = (name, category) =>\n    !!subCategory\n      ? name === mainCategory && category === subCategory\n      : name === mainCategory;\n\n  return (\n    !isProductLoading && (\n      <div className=\"sortedProducts\">\n        {isPopModal && (\n          <ModalBuyNow\n            setIsPopModal={setIsPopModal}\n            infoTag={adjustList.description}\n            product={selectedProduct}\n          />\n        )}\n        <div className={isPopModal ? 'mask' : 'maskOff'} />\n        <div className=\"sortedProductsHead\">\n          <div className=\"sortedProductsTitle\">\n            {`${TRANSELATE[mainCategory]}`}\n            {subCategory && ` > ${TRANSELATE[subCategory]}`}\n          </div>\n          <SortSelectArea adjustList={adjustList} productsList={productsList} />\n        </div>\n        <div className=\"sortedProductsContainer\">\n          {(mainCategory === 'all'\n            ? productsList\n            : productsList.filter(({ category: { name, category } }) =>\n                checkCategory(name, category)\n              )\n          ).map(el => (\n            <Product\n              el={el}\n              key={el.id}\n              id={el.id}\n              btnOnClick={PopUpModalBuyNow}\n              updateLike={updateLike}\n            />\n          ))}\n        </div>\n      </div>\n    )\n  );\n};\n\nexport default SortedProducts;\n"]},"metadata":{},"sourceType":"module"}