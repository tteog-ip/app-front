{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/user/Desktop/2\\uCC28\\uD504\\uB85C\\uC81D\\uD2B8/DrTart-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState}from'react';import{useParams}from'react-router-dom';import SortSelectArea from'../ProductsSorted/SortSelectArea/SortSelectArea';import Product from'../Product/Product';import ModalBuyNow from'../ModalBuyNow/ModalBuyNow';import{TRANSELATE}from'../Transelate';import{API_ADDRESS}from'../../../apiConfig';import'./SortedProducts.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SortedProducts=function SortedProducts(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isProductLoading=_useState2[0],setIsProductLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),productsList=_useState4[0],setProductsList=_useState4[1];var _useParams=useParams(),mainCategory=_useParams.mainCategory,subCategory=_useParams.subCategory;var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isPopModal=_useState6[0],setIsPopModal=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),selectedProduct=_useState8[0],setSelectedProduct=_useState8[1];var PopUpModalBuyNow=function PopUpModalBuyNow(product){setIsPopModal(true);setSelectedProduct(product);};var updateLike=function updateLike(id){var updatedList=productsList.map(function(product){if(id===product.id){return product.is_like_True?_objectSpread(_objectSpread({},product),{},{is_like_True:!product.is_like_True,like_num:product.like_num-1}):_objectSpread(_objectSpread({},product),{},{is_like_True:!product.is_like_True,like_num:product.like_num+1});}else{return _objectSpread({},product);}});setProductsList(updatedList);};var fetchData=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var address,data,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(mainCategory==='all'){address=API_ADDRESS.product_all;}else{address=subCategory?\"\".concat(API_ADDRESS.products_category).concat(subCategory):\"\".concat(API_ADDRESS.products_menu).concat(mainCategory);}_context.next=3;return fetch(address);case 3:data=_context.sent;_context.next=6;return data.json();case 6:res=_context.sent;setProductsList(res.product_list.sort(function(a,b){return Date.parse(b.create_at)-Date.parse(a.create_at);}));case 8:case\"end\":return _context.stop();}}},_callee);})),[mainCategory,subCategory]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsProductLoading(true);_context2.next=3;return fetchData();case 3:setIsProductLoading(false);case 4:case\"end\":return _context2.stop();}}},_callee2);}))();},[fetchData,subCategory,mainCategory]);var adjustList=function adjustList(products){setProductsList(products);};var checkCategory=function checkCategory(name,category){return!!subCategory?name===mainCategory&&category===subCategory:name===mainCategory;};return!isProductLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"sortedProducts\",children:[isPopModal&&/*#__PURE__*/_jsx(ModalBuyNow,{setIsPopModal:setIsPopModal,infoTag:adjustList.description,product:selectedProduct}),/*#__PURE__*/_jsx(\"div\",{className:isPopModal?'mask':'maskOff'}),/*#__PURE__*/_jsxs(\"div\",{className:\"sortedProductsHead\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sortedProductsTitle\",children:[\"\".concat(TRANSELATE[mainCategory]),subCategory&&\" > \".concat(TRANSELATE[subCategory])]}),/*#__PURE__*/_jsx(SortSelectArea,{adjustList:adjustList,productsList:productsList})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sortedProductsContainer\",children:(mainCategory==='all'?productsList:productsList.filter(function(_ref3){var _ref3$category=_ref3.category,name=_ref3$category.name,category=_ref3$category.category;return checkCategory(name,category);})).map(function(el){return/*#__PURE__*/_jsx(Product,{el:el,id:el.id,btnOnClick:PopUpModalBuyNow,updateLike:updateLike},el.id);})})]});};export default SortedProducts;","map":{"version":3,"names":["React","useCallback","useEffect","useState","useParams","SortSelectArea","Product","ModalBuyNow","TRANSELATE","API_ADDRESS","jsx","_jsx","jsxs","_jsxs","SortedProducts","_useState","_useState2","_slicedToArray","isProductLoading","setIsProductLoading","_useState3","_useState4","productsList","setProductsList","_useParams","mainCategory","subCategory","_useState5","_useState6","isPopModal","setIsPopModal","_useState7","_useState8","selectedProduct","setSelectedProduct","PopUpModalBuyNow","product","updateLike","id","updatedList","map","is_like_True","_objectSpread","like_num","fetchData","_asyncToGenerator","_regeneratorRuntime","mark","_callee","address","data","res","wrap","_callee$","_context","prev","next","product_all","concat","products_category","products_menu","fetch","sent","json","product_list","sort","a","b","Date","parse","create_at","stop","_callee2","_callee2$","_context2","adjustList","products","checkCategory","name","category","className","children","infoTag","description","filter","_ref3","_ref3$category","el","btnOnClick"],"sources":["C:/Users/user/Desktop/2차프로젝트/DrTart-frontend/src/pages/ProductList/SortedProducts/SortedProducts.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport SortSelectArea from '../ProductsSorted/SortSelectArea/SortSelectArea';\nimport Product from '../Product/Product';\nimport ModalBuyNow from '../ModalBuyNow/ModalBuyNow';\nimport { TRANSELATE } from '../Transelate';\nimport { API_ADDRESS } from '../../../apiConfig';\nimport './SortedProducts.scss';\n\nconst SortedProducts = () => {\n  const [isProductLoading, setIsProductLoading] = useState(false);\n  const [productsList, setProductsList] = useState([]);\n  const { mainCategory, subCategory } = useParams();\n  const [isPopModal, setIsPopModal] = useState(false);\n  const [selectedProduct, setSelectedProduct] = useState({});\n\n  const PopUpModalBuyNow = product => {\n    setIsPopModal(true);\n    setSelectedProduct(product);\n  };\n\n  const updateLike = id => {\n    const updatedList = productsList.map(product => {\n      if (id === product.id) {\n        return product.is_like_True\n          ? {\n              ...product,\n              is_like_True: !product.is_like_True,\n              like_num: product.like_num - 1,\n            }\n          : {\n              ...product,\n              is_like_True: !product.is_like_True,\n              like_num: product.like_num + 1,\n            };\n      } else {\n        return { ...product };\n      }\n    });\n    setProductsList(updatedList);\n  };\n\n  const fetchData = useCallback(async () => {\n    let address;\n    if (mainCategory === 'all') {\n      address = API_ADDRESS.product_all;\n    } else {\n      address = subCategory\n        ? `${API_ADDRESS.products_category}${subCategory}`\n        : `${API_ADDRESS.products_menu}${mainCategory}`;\n    }\n    const data = await fetch(address);\n    const res = await data.json();\n\n    setProductsList(\n      res.product_list.sort(\n        (a, b) => Date.parse(b.create_at) - Date.parse(a.create_at)\n      )\n    );\n  }, [mainCategory, subCategory]);\n\n  useEffect(() => {\n    (async () => {\n      setIsProductLoading(true);\n      await fetchData();\n      setIsProductLoading(false);\n    })();\n  }, [fetchData, subCategory, mainCategory]);\n\n  const adjustList = products => {\n    setProductsList(products);\n  };\n\n  const checkCategory = (name, category) =>\n    !!subCategory\n      ? name === mainCategory && category === subCategory\n      : name === mainCategory;\n\n  return (\n    !isProductLoading && (\n      <div className=\"sortedProducts\">\n        {isPopModal && (\n          <ModalBuyNow\n            setIsPopModal={setIsPopModal}\n            infoTag={adjustList.description}\n            product={selectedProduct}\n          />\n        )}\n        <div className={isPopModal ? 'mask' : 'maskOff'} />\n        <div className=\"sortedProductsHead\">\n          <div className=\"sortedProductsTitle\">\n            {`${TRANSELATE[mainCategory]}`}\n            {subCategory && ` > ${TRANSELATE[subCategory]}`}\n          </div>\n          <SortSelectArea adjustList={adjustList} productsList={productsList} />\n        </div>\n        <div className=\"sortedProductsContainer\">\n          {(mainCategory === 'all'\n            ? productsList\n            : productsList.filter(({ category: { name, category } }) =>\n                checkCategory(name, category)\n              )\n          ).map(el => (\n            <Product\n              el={el}\n              key={el.id}\n              id={el.id}\n              btnOnClick={PopUpModalBuyNow}\n              updateLike={updateLike}\n            />\n          ))}\n        </div>\n      </div>\n    )\n  );\n};\n\nexport default SortedProducts;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}